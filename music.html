<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Evie McNaughton</title>
    <link rel="icon" href="/assets/favicon2020.ico">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/mobile-style.css">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    
    <!-- load jquery and jsrender libraries -->
    <script type="text/javascript" src="scripts/js/lastfm.api.md5.js"></script>
    <script type="text/javascript" src="scripts/js/lastfm.api.js"></script>
    <script type="text/javascript" src="scripts/js/lastfm.api.cache.js"></script>
    <script>
        var api_key = 'ede34f68bfab5ab14120091e2f7d41d0';
        var user = 'eviemcnaughton';
        var api_root = 'https://ws.audioscrobbler.com/2.0/';
        var lastfm_root = 'https://www.last.fm/music/';
        var speaker_class = 'glyphicon glyphicon-volume-up';

        var album_class = "album-cover";
        var link_class = "album-link";
        var hover_class = "album-animation";
        var text_container_class = "text-container";
        var info_wrapper_class = "album-info-wrapper";
        var info_class = "album-info";
        var info_text_class = "album-info-text";

        $(document).ready(function() {

            // request albums
            var albumsRequest = new XMLHttpRequest();
            albumsRequest.onreadystatechange = function() {
                if (this.readyState === 4 && this.status === 200) {
                    processAlbumsRequest(JSON.parse(this.response));
                }
            };

            albumsRequest.open("GET", api_root + "?method=user.gettopalbums&period=1month&user=" + user + "&api_key=" + api_key + "&format=json")
            albumsRequest.send();

        });

        // loads the album cover grid based on the api response when top albums is requested.
        function processAlbumsRequest(response) {

            var container = document.getElementById("album-collage");
            var albums = response.topalbums.album;

            // loop through all albums and render them in the div specified by id "album-collage".
            for (var i = 0; i < albums.length; i++) {
                var album = albums[i];
                var imageURL = album.image[2]['#text'];

                // create the album-cover.
                var cover = document.createElement("div");
                cover.className = album_class;
                cover.style.backgroundImage = "url('" + imageURL + "')";

                // construct the text div to overlay it and append it to the cover div.
                var textDiv = constructAlbumTextDiv(album);

                cover.appendChild(textDiv);
                container.appendChild(cover);
            }
        }


        // helper to create the div that will be added to the album-cover, holding info about the album.
        function constructAlbumTextDiv(albumObj) {
            var artistName = albumObj.artist.name;
            var albumName = albumObj.name;
            var plays = albumObj.playcount;
            var albumLink = albumObj.url;

            var info = document.createElement("div");
            info.className = info_class;

            var infoText = document.createElement("div");
            infoText.className = info_text_class;
            info.appendChild(infoText);

            var textWrapper = document.createElement("div");
            textWrapper.className = info_wrapper_class;
            textWrapper.appendChild(info);

            var titleEl = document.createElement("h5");
            titleEl.appendChild(document.createTextNode(albumName));
            infoText.appendChild(titleEl);

            var artistEl = document.createElement("h5");
            artistEl.appendChild(document.createTextNode(artistName));
            infoText.appendChild(artistEl);

            var playCountEl = document.createElement("h5");
            playCountEl.appendChild(document.createTextNode("Plays: " + plays));
            infoText.appendChild(playCountEl);

            var textContainer = document.createElement("div");
            textContainer.className = text_container_class;
            textContainer.appendChild(textWrapper);

            // make the album cover into a link
            var albumLinkElement = document.createElement("a");
            albumLinkElement.href = albumLink;
            albumLinkElement.target = '_blank';
            var linkSpan = document.createElement("span");
            linkSpan.className = link_class;
            albumLinkElement.appendChild(linkSpan);
            textContainer.appendChild(albumLinkElement);

            return textContainer;
        }
    </script>
    
</head>

<body>
    <header>
        <div class="container-fluid p-0">
            <nav class="navbar navbar-expand-lg fixed-top bg-light" id="nav1">
              <a class="navbar-brand" href="index.html">
                  <img src="/assets/logo2020.png" alt="logo" class="img-fluid">
                  </a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"><i class="fas fa-align-justify"></i></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNav">
                <div class="mr-auto"></div>
                <ul class="navbar-nav">
                  <li class="nav-item active">
                    <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="projects.html">Projects</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="music.html">Music</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="index.html#C4">About</a>
                  </li>
                </ul>
              </div>
            </nav>
        </div>
    </header>
    <main>
       <section class="section-4">
            <h4>Music :</h4>
            <p>Space to put music etc. Show off lastfm API play around. Maybe put in favourite albums currently etc.</p>
        </section>
        <div class="container-fluid page-section no-padding" id="album-collage">


        </div>
        
    </main>
    <footer>
        <div class="container-fluid p-0">
            <div class="row text-center">
                <div class="col-md-5"></div>
                <div class="col-md-2 col-sm-12">
                    <h2>Find Me</h2>
                    <div class="column">
                        <a href="mailto:evie.mcnaughton@gmail.com" title="Email"><i class="far fa-envelope"></i></a>
                        <a href="https://github.com/eviemcn" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://www.linkedin.com/in/evie-mcnaughton/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                        <a href="https://www.pinterest.nz/eviemcnaughton/boards/" target="_blank" title="Pinterest"><i class="fab fa-pinterest"></i></a>
                        <a href="https://www.instagram.com/eviemcnaughton/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://open.spotify.com/user/12140180831" target="_blank" title="Spotify"><i class="fab fa-spotify"></i></a>
                    </div>
                </div>
                <div class="col-md-5"></div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</body>

</html>
